diff --git a/ext/misc/rot13.c b/ext/misc/rot13.c
--- a/ext/misc/rot13.c
+++ b/ext/misc/rot13.c
@@ -54,7 +54,7 @@ static void rot13func(
   if( sqlite3_value_type(argv[0])==SQLITE_NULL ) return;
   zIn = (const unsigned char*)sqlite3_value_text(argv[0]);
   nIn = sqlite3_value_bytes(argv[0]);
-  if( nIn<=sizeof(zTemp) ){
+  if( nIn<sizeof(zTemp)-1 ){
     zOut = zTemp;
   }else{
     zOut = zToFree = (unsigned char*)sqlite3_malloc64( nIn+1 );
