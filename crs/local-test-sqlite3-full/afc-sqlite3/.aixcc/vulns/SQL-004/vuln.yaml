metadata_spec_version: v1

name: Heap OOB Read on SQLite shell error context

author: austintice

details:

  cwes:
    - CWE-125

  description: >
    The problem stems from the `sqlite3_error_offset()`` routine returning a value that is out-of-range for its input. Then, the CLI code that uses ``sqlite3_error_offset()`` fails to properly deal with the out-of-range return value. This leads to crashes for certain malformed inputs that cause out of bounds reads on the heap.

  locations:
    - path_from_root: "src/shell.c.in"
      startLine: 3089
      startColumn: 1
      endLine: 3121
      endColumn: 1

pov:
  harness: 'customfuzz3'
  blob: 'data.bin'

patch:
  good: 'good_patch.diff'
  bad: 'bad_patch.diff'
